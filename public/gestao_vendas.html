<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Venda de Balcão</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="bg-gray-100 p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <div class="mb-4">
            <a href="index.html" class="text-blue-600 hover:underline">&larr; Voltar à Página Inicial</a>
        </div>
        <h1 class="text-3xl font-bold text-gray-800 mb-6">Venda de Balcão</h1>

        <form id="venda-form">
            <div class="grid grid-cols-1 lg:grid-cols-3 lg:gap-8">

                <div class="lg:col-span-2 space-y-6">
                    <div class="card">
                        <h2 class="text-xl font-semibold text-gray-700 mb-4">1. Cliente (Opcional)</h2>
                        <div class="autocomplete-container">
                           <input type="text" id="input-search-cliente" placeholder="Digite para buscar um cliente..." class="form-input w-full mt-1 text-sm">
                           <div id="results-cliente" class="autocomplete-results hidden"></div>
                        </div>
                    </div>

                    <div class="card">
                        <h2 class="text-xl font-semibold text-gray-700 mb-4">2. Adicione Itens</h2>
                        <div class="flex flex-col md:flex-row items-end gap-3">
                            <div class="flex-grow w-full autocomplete-container">
                                <label class="text-sm">Adicionar Item</label>
                                <input type="text" id="input-search-produto" placeholder="Digite para buscar um item..." class="form-input w-full mt-1 text-sm">
                                <div id="results-produto" class="autocomplete-results hidden"></div>
                            </div>
                            <div class="w-full md:w-auto"><label for="input-produto-qtd" class="block text-sm font-medium text-gray-700">Qtd.</label><input type="number" id="input-produto-qtd" value="1" min="1" class="form-input w-20 mt-1"></div>
                            <button type="button" id="btn-add-produto" class="bg-gray-700 hover:bg-gray-800 text-white font-semibold py-2 px-4 rounded-lg h-10 w-full md:w-auto">Adicionar</button>
                        </div>
                        <hr class="my-4">
                        <div class="flex flex-col md:flex-row items-end gap-3">
                        <div class="flex-grow w-full autocomplete-container">
                            <label class="text-sm">Adicionar Serviço</label>
                            <input type="text" id="input-search-servico" placeholder="Digite para buscar um serviço..." class="form-input w-full mt-1 text-sm">
                            <div id="results-servico" class="autocomplete-results hidden"></div>
                        </div>
                        <div class="w-full md:w-auto"><label for="input-servico-qtd" class="block text-sm font-medium text-gray-700">Qtd.</label><input type="number" id="input-servico-qtd" value="1" min="1" class="form-input w-20 mt-1"></div>

                        <button type="button" id="btn-add-servico" class="bg-gray-700 hover:bg-gray-800 text-white font-semibold py-2 px-4 rounded-lg h-10 w-full md:w-auto">Adicionar</button>
                    </div>
                    </div>
                </div>

                <div class="lg:col-span-1">
                    <div class="card">
                        <h2 class="text-xl font-semibold text-gray-700 mb-4">Resumo da Venda</h2>
                        
                        <div id="itens-venda-container" class="min-h-[120px] space-y-2">
                            <p id="carrinho-vazio-msg" class="text-gray-500 text-center py-4">Nenhum item adicionado.</p>
                        </div>

                        <div class="border-t mt-4 pt-4 space-y-2 text-sm">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">Subtotal:</span>
                                <span id="subtotal-valor" class="font-semibold">R$ 0,00</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <div class="flex items-center gap-2">
                                    <label for="desconto-valor" class="text-gray-600">Desconto:</label>
                                    <select id="desconto-tipo" class="form-input p-1 h-7 text-xs rounded-md">
                                        <option value="R$">R$</option>
                                        <option value="%">%</option>
                                    </select>
                                </div>
                                <input type="number" id="desconto-valor" value="0" min="0" class="form-input w-24 text-right p-1 h-7 text-sm rounded-md">
                            </div>
                            <div id="desconto-aplicado-container" class="flex justify-between items-center text-red-600 hidden">
                                <span>Desconto Aplicado:</span>
                                <span id="desconto-aplicado-valor" class="font-semibold">- R$ 0,00</span>
                            </div>
                        </div>

                        <div class="border-t mt-4 pt-4">
                            <div class="flex justify-between items-center text-2xl font-bold text-gray-800">
                                <span>TOTAL:</span>
                                <span id="total-valor">R$ 0,00</span>
                            </div>
                        </div>
                        <div class="border-t mt-4 pt-4 space-y-3">
    
    <div>
        <label for="select-forma-pagamento" class="block text-sm font-bold text-gray-700">Forma de Pagamento:</label>
        <select id="select-forma-pagamento" class="form-input w-full mt-1" required>
            <option value="">A carregar formas...</option>
        </select>
    </div>

    <div id="bloco-parcelamento" class="hidden space-y-2">
        <div>
            <label for="select-num-parcelas" class="block text-sm font-bold text-gray-700">Número de Parcelas:</label>
            <select id="select-num-parcelas" class="form-input w-full mt-1">
                </select>
        </div>
        
        <div id="info-taxa-parcela" class="hidden text-sm text-gray-700 bg-gray-100 p-2 rounded-md">
            <p>Taxa de 5% (R$ <span id="valor-taxa">0,00</span>) aplicada.</p>
            <p class="font-bold">Total: <span id="total-parcelado">3x de R$ 95,00</span></p>
        </div>
    </div>

    <div id="bloco-conta-caixa" class="hidden">
        <label for="select-conta-caixa" class="block text-sm font-bold text-gray-700">Pagar para (Conta/Caixa):</label>
        <select id="select-conta-caixa" class="form-input w-full mt-1">
            <option value="">A carregar contas...</option>
        </select>
    </div>

    <div id="bloco-data-vencimento" class="hidden">
        <label for="input-data-vencimento" class="block text-sm font-bold text-gray-700">Data de Vencimento:</label>
        <input type="date" id="input-data-vencimento" class="form-input w-full mt-1">
    </div>
</div>

                        <button type="submit" id="btn-finalizar-venda" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg mt-6 text-lg shadow disabled:bg-gray-400 disabled:cursor-not-allowed">Finalizar Venda</button>
                    </div>
                </div>

            </div> </form>
        
        <div id="feedback-alert" class="hidden"></div> 
        <div id="venda-confirmacao" class="card mt-6 text-center" style="display: none;">
            <h2 class="text-2xl font-bold text-green-600">Venda Finalizada com Sucesso!</h2>
            <p id="confirmacao-texto" class="text-gray-700 mt-2 mb-4"></p>
            <button id="btn-imprimir-recibo" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg shadow">Imprimir Recibo</button>
            <button id="btn-nova-venda" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg shadow ml-3">Registar Nova Venda</button>
        </div>
    </div>
    
<template id="recibo-template">
    <html>
    <head>
        <title>Recibo de Venda</title>
        <style>
            body { font-family: 'Arial', sans-serif; margin: 0; padding: 20px; color: #333; font-size: 12px; }
            .recibo-box { border: 1px solid #eee; padding: 20px; max-width: 800px; margin: auto; box-shadow: 0 0 5px rgba(0,0,0,0.1); }
            .header { display: flex; justify-content: space-between; align-items: flex-start; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 20px; }
            .header .empresa h1 { font-size: 20px; margin: 0; }
            .header .empresa p { margin: 0; font-size: 12px; color: #555; }
            .header .detalhes { text-align: right; }
            .header .detalhes h2 { font-size: 18px; margin: 0; }
            .cliente-info { margin-bottom: 20px; }
            .cliente-info p { margin: 2px 0; }
            .itens-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
            .itens-table th, .itens-table td { padding: 8px; border-bottom: 1px solid #eee; text-align: left; }
            .itens-table th { background-color: #f9f9f9; font-size: 11px; text-transform: uppercase; }
            .itens-table .text-center { text-align: center; }
            .itens-table .text-right { text-align: right; }
            .total-section { margin-top: 20px; float: right; width: 250px; }
            .total-section div { display: flex; justify-content: space-between; padding: 5px 0; }
            .total-section .total-final { font-size: 18px; font-weight: bold; border-top: 2px solid #333; margin-top: 5px; }
            .footer { margin-top: 80px; text-align: center; font-size: 12px; color: #555; clear: both; }
        </style>
    </head>
    <body>
        <div class="recibo-box">
            <div class="header">
                <div class="empresa">
                    <h1>Saulo Cardoso Oficina de Motos</h1>
                    <p>Avenida Central, 33 - Inajá-PE</p>
                </div>
                <div class="detalhes">
                    <h2>RECIBO DE VENDA</h2>
                    <p><strong>Venda #<span data-recibo="venda-id"></span></strong></p>
                    <p>Data: <span data-recibo="data"></span></p>
                </div>
            </div>
            <div class="cliente-info">
                <p><strong>Cliente:</strong> <span data-recibo="cliente-nome"></span></p>
            </div>
            <table class="itens-table">
                <thead>
                    <tr>
                        <th>Descrição</th>
                        <th class="text-center">Qtd.</th>
                        <th class="text-right">Vlr. Unit.</th>
                        <th class="text-right">Subtotal</th>
                    </tr>
                </thead>
                <tbody data-recibo="itens-tabela"></tbody>
            </table>
            <div class="total-section">
                <div>
                    <span>Subtotal:</span>
                    <span data-recibo="subtotal">R$ 0,00</span>
                </div>
                <div data-recibo="desconto-info" class="hidden">
                    <span>Desconto:</span>
                    <span data-recibo="desconto" class="text-red-600">- R$ 0,00</span>
                </div>
                <div class="total-final">
                    <span>TOTAL:</span>
                    <span data-recibo="total">R$ 0,00</span>
                </div>
            </div>
            <div class="footer">
                <p>Obrigado pela sua preferência!</p>
            </div>
        </div>
    </body>
    </html>
</template>

    <script src="js/gestao_vendas.js"></script>
</body>
</html>